/*-----------------------------------------------------------------------------------------
 * Author:          Rachel Jacquay
 * Course:          EGR 226-902
 * Date:            04/04/2021
 * Project:         Lab 11 Parts 1 + 2
 * File:            main.c
 * Description:     This lab works with IR emitter and receiver to
-----------------------------------------------------------------------------------------*/

// libraries
#include "msp.h"
#include "stdio.h"

// globals
uint8_t detect10Hz;
volatile uint16_t lastedge, currentedge, period;

// function prototypes
void emitter_init(void);

void main(void) {
    __disable_irq();                                // disable irq
    WDT_A->CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;		// stop watchdog timer
    emitter_init();                                 // initializations

    __enable_irq();                 // enable irq

    while(1) {

    }
}

/*--------------------------------------------------------------
 * Function:        emitter_init
 *
 * Description:     This function initializes the emitter LED
 *                  so that it blinks at 10Hz.
 *
 * Inputs:          none
 *
 * Outputs:         none
 *-------------------------------------------------------------*/
void emitter_init(void) {
    P2->SEL0 |= BIT4;   // P2.4 set TA0.1
    P2->SEL1 &= ~BIT4;
    P2->DIR |= BIT4;

    TIMER_A0->CTL = TIMER_A_CTL_SSEL__SMCLK | TIMER_A_CTL_MC__UP | TIMER_A_CTL_CLR | TIMER_A_CTL_ID__8;

    TIMER_A0->CCR[0] = 37509;
    TIMER_A0->CCR[1] = 37509 / 2;

    TIMER_A0->CCTL[1] = TIMER_A_CCTLN_OUTMOD_7;
}
