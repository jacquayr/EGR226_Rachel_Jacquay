/*
 * ArmUnarm.c
 *
 *  Created on: Apr 15, 2021
 *      Author: rache
 */

#include "ArmUnarm.h"
#include "Keypad.h"
#include "Menu.h"
#include "Backlight.h"

void arm(void) {
    int p1, p2, p3, sum, push, flag;
    p1 = 0;
    p2 = 0;
    p3 = 0;
    sum = 0;
    push = 0;
    flag = 0;
    armSum = 0;

    passcode();          // tell user to press 3 buttons (000-100)
    flag = 1;

    while (flag) {
        changeBL();     // update backlight

        push = Read_Keypad();   // read keypad

        if (push) {                                     // if key is pressed
            if (num == 10 | num == 11 | num == 12) {    // if num is * 0 #
                num = 0;                                // num is 0
            }
            p1 = num;           // push 1 is num
            push = 0;
            flag = 0;
        }
    }

    flag = 1;

    while (flag) {
        changeBL();     // update backlight

        push = Read_Keypad();   // read keypad

        if (push) {                                     // if key is pressed
            if (num == 10 | num == 11 | num == 12) {    // if num is * 0 #
                num = 0;                                // num is 0
            }
            p2 = num;           // push 2 is num
            push = 0;
            flag = 0;
        }
    }

    flag = 1;

    while (flag) {
        changeBL();     // update backlight

        push = Read_Keypad();   // read keypad

        if (push) {                                     // if key is pressed
            if (num == 10 | num == 11 | num == 12) {
                num = 0;
            }
            p3 = num;
            push = 0;
            flag = 0;
        }
    }

    p1 *= 100;
    p2 *= 10;
    sum = p1 + p2 + p3;

    if (sum >= 100) {
        sum = 100;
    }

    armSum = sum;

    if (armSum != 0) {      // if DC is not zero
        armed = 1;          // tell user that red is ON
    }

    if (armSum == 0) {      // if DC is zero
        armed = 0;          // tell user that red is OFF
    }
}

//void unarmDoor(void) {
//
//}
